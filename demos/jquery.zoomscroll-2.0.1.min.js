/*
 * ZoomScroll - FancyBox Plugin
 * Zooming image with scroll
 *
 * Examples and documentation at: http://zoomscroll.com/
 *
 * Copyright (c) 2011 Kirill Shaparov, http://shaparov.ru/
 *
 * Version: 2.0.1 (09/12/2011)
 * Requires: jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
;(function(a){var h="",c="",e=0,f=0,j=l_b=20,b=w_o=0,k=function(){w_n=w_o-l_b;a("#zoomscroll-image-view").css({width:w_n});h_n=f*w_n/e;a("#zoomscroll-image-view").css({height:h_n})},l=function(){h_n=b-j;a("#zoomscroll-image-view").css({height:h_n});w_n=e*h_n/f;a("#zoomscroll-image-view").css({width:w_n})},m=function(){a("#zoomscroll-image-view").draggable({cursor:"move",scroll:!1,containment:[30-a("#zoomscroll-image-view").width(),30-a("#zoomscroll-image-view").height(),w_o-30,b-30]})},n=function(d){a("#zoomscroll-image-view").animate({opacity:d},300,function(){d?a("body").css({overflow:"hidden",position:"fixed",width:"100%",height:"100%"}):(a("#zoomscroll-image-overlay, #zoomscroll-image-close, #zoomscroll-image-view").remove(),a("body").css({overflow:"",position:"",width:"",height:""}))})},o=function(){e=c.width;f=c.height;a("#zoomscroll-image-preload").remove();a("body").append("<div id='zoomscroll-image-overlay'></div><img id='zoomscroll-image-view' src='"+h+"' /><div id='zoomscroll-image-close'></div>");a("#zoomscroll-image-overlay").css({height:a(window).height()+20});b=a(window).height();w_o=a(window).width();e>w_o-l_b?(k(),h_n>b-j&&l()):f>b-j?(l(),w_n>w_o-l_b&&k()):(h_n=f,w_n=e);a("#zoomscroll-image-view").css({top:(b-h_n)/2,left:(w_o-w_n)/2});a("#zoomscroll-image-overlay, #zoomscroll-image-close").live("click",a.zoomscroll.close);a("#zoomscroll-image-view").bind("mousewheel",function(d,b){a("#zoomscroll-image-view").stop();var g=a("#zoomscroll-image-view").width(),c=a("#zoomscroll-image-view").height(),e=d.layerX==void 0?d.offsetX:d.layerX,f=d.layerY==void 0?d.offsetY:d.layerY;a("#zoomscroll-image-overlay").width();a("#zoomscroll-image-overlay").height();var i=b>0?1.25:0.555;if(!(g<100&&b<0||g>1E4&&b>0)){var h=g+b*Math.round(g*i),i=c+b*Math.round(c*i),g=Math.ceil(a("#zoomscroll-image-view").position().left-e*(h/g-1)),c=Math.ceil(a("#zoomscroll-image-view").position().top-f*(i/c-1));a("#zoomscroll-image-view").draggable("destroy");a("#zoomscroll-image-view").animate({left:g,width:h,top:c,height:i},600,m)}});a("#zoomscroll-image-view").dblclick(function(){a("#zoomscroll-image-view").draggable("destroy");a("#zoomscroll-image-view").stop().animate({width:w_n,height:h_n,left:(w_o-w_n)/2,top:(b-h_n)/2},500,m)});a("#zoomscroll-image-view").live("mousedown",function(){return!1});a("#zoomscroll-image-view").draggable({containment:[30-w_n,30-h_n,w_o-30,b-30]});n(1)};a.fn.zoomscroll=function(){a(this).live("click",a.zoomscroll.open);return this};a.zoomscroll=function(){};a.zoomscroll.open=function(){if(a("#zoomscroll-image-preload").length)return!1;a(this).append("<div id='zoomscroll-image-preload'></div>");a("#zoomscroll-image-preload").css({"margin-left":a(this).find("img").width()/2-21,"margin-top":-(a(this).find("img").height()/2+21)});h=a(this).attr("href");c=new Image;c.src=h;c.complete?o():c.onload=o;return!1};a.zoomscroll.close=function(){n(0)}})(jQuery);